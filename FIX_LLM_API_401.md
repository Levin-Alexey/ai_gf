# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ 401 LLM API

## üîç –ü—Ä–æ–±–ª–µ–º–∞
–í–æ—Ä–∫–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç –æ—à–∏–±–∫—É **401 Unauthorized** –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ LLM API:

```
ERROR:__main__:–û—à–∏–±–∫–∞ LLM API: 401
ERROR:__main__:‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç –æ—Ç LLM –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 525944420
```

## üîç –ü—Ä–∏—á–∏–Ω–∞
–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω API –∫–ª—é—á –¥–ª—è LLM —Å–µ—Ä–≤–∏—Å–∞.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. –ü–æ–ª—É—á–∏—Ç–µ API –∫–ª—é—á

#### –í–∞—Ä–∏–∞–Ω—Ç A: OpenAI API
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [platform.openai.com](https://platform.openai.com)
2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å/–≤–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ [API Keys](https://platform.openai.com/api-keys)
4. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π API –∫–ª—é—á
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–ª—é—á (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `sk-...`)

#### –í–∞—Ä–∏–∞–Ω—Ç B: OpenRouter API (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [openrouter.ai](https://openrouter.ai)
2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å/–≤–æ–π–¥–∏—Ç–µ
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ [Keys](https://openrouter.ai/keys)
4. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π API –∫–ª—é—á
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–ª—é—á (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `sk-or-...`)

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env —Ñ–∞–π–ª

–ù–∞ –≤–∞—à–µ–º VDS –¥–æ–±–∞–≤—å—Ç–µ –≤ —Ñ–∞–π–ª `.env`:

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ VDS
ssh root@–≤–∞—à_vds_ip

# –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª .env
nano /root/ai_gf/.env
```

–î–æ–±–∞–≤—å—Ç–µ –æ–¥–Ω—É –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π:

#### –î–ª—è OpenAI:
```env
LLM_API_URL=https://api.openai.com/v1/chat/completions
LLM_API_KEY=sk-your_openai_api_key_here
LLM_MODEL=gpt-3.5-turbo
```

#### –î–ª—è OpenRouter (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
```env
LLM_API_URL=https://openrouter.ai/api/v1/chat/completions
OPENROUTER_API_KEY=sk-or-your_openrouter_api_key_here
LLM_MODEL=openai/gpt-3.5-turbo
```

### 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –≤–æ—Ä–∫–µ—Ä

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤–æ—Ä–∫–µ—Ä
sudo systemctl stop ai-gf-worker

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤–æ—Ä–∫–µ—Ä
sudo systemctl start ai-gf-worker

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
sudo systemctl status ai-gf-worker

# –°–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏
journalctl -u ai-gf-worker -f
```

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ API –∫–ª—é—á –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
cd /root/ai_gf
source venv/bin/activate
python -c "
from config import LLM_API_KEY, LLM_API_URL, LLM_MODEL
print(f'API URL: {LLM_API_URL}')
print(f'API Key: {LLM_API_KEY[:10]}...' if LLM_API_KEY else 'API Key: –ù–ï –ù–ê–ô–î–ï–ù!')
print(f'Model: {LLM_MODEL}')
"
```

### 2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç—É
–ù–∞–ø–∏—à–∏—Ç–µ –±–æ—Ç—É –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:

```bash
journalctl -u ai-gf-worker --since "1 minute ago"
```

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```
INFO:__main__:ü§ñ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –∫ LLM API –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 525944420
INFO:__main__:‚úÖ –ü–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç –æ—Ç LLM –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 525944420
INFO:__main__:–û—Ç–≤–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ —á–∞—Ç 525944420
```

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### OpenRouter vs OpenAI
- **OpenRouter** - –¥–µ—à–µ–≤–ª–µ, –±–æ–ª—å—à–µ –º–æ–¥–µ–ª–µ–π, –ø—Ä–æ—â–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- **OpenAI** - –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π API, –Ω–æ –¥–æ—Ä–æ–∂–µ

### –ú–æ–¥–µ–ª–∏
- `openai/gpt-3.5-turbo` - –±—ã—Å—Ç—Ä–∞—è –∏ –¥–µ—à–µ–≤–∞—è
- `openai/gpt-4` - –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–µ–µ, –Ω–æ –¥–æ—Ä–æ–∂–µ
- `anthropic/claude-3-haiku` - —Ö–æ—Ä–æ—à–µ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ü–µ–Ω–∞/–∫–∞—á–µ—Å—Ç–≤–æ

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ `.env` —Ñ–∞–π–ª –≤ git
- –†–µ–≥—É–ª—è—Ä–Ω–æ —Ä–æ—Ç–∏—Ä—É–π—Ç–µ API –∫–ª—é—á–∏
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ –ª–∏–º–∏—Ç—ã –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

## üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ï—Å–ª–∏ API –∫–ª—é—á –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª .env
cat /root/ai_gf/.env | grep -E "(LLM_API_KEY|OPENROUTER_API_KEY)"

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
sudo systemctl daemon-reload
sudo systemctl restart ai-gf-worker
```

### –ï—Å–ª–∏ –≤—Å–µ –µ—â–µ –æ—à–∏–±–∫–∞ 401:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å API –∫–ª—é—á–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞ —Å—á–µ—Ç—É –µ—Å—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏–º–∏—Ç—ã API
4. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π API –∫–ª—é—á

### –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ 429 (Rate Limit):
```bash
# –î–æ–±–∞–≤—å—Ç–µ –≤ .env –∑–∞–¥–µ—Ä–∂–∫—É –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
LLM_REQUEST_DELAY=1
```

## üìä –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ API –∫–ª—é—á–∞:
- ‚úÖ –í–æ—Ä–∫–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã –æ—Ç LLM
- ‚úÖ –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –°–æ–æ–±—â–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –∏—Å—Ç–æ—Ä–∏—é
- ‚úÖ –í–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

## üéØ –ò—Ç–æ–≥

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ API –∫–ª—é—á–∞ - —ç—Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–≥ –¥–ª—è –ø–æ–ª–Ω–æ–π —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤–∞—à AI –±–æ—Ç –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω!
