#!/bin/bash

echo "üîß –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ aio-pika (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π RabbitMQ)"
echo "================================================"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ –ª–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
if [[ -z "$VIRTUAL_ENV" ]]; then
    echo "‚ö†Ô∏è  –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ!"
    echo "–ê–∫—Ç–∏–≤–∏—Ä—É–µ–º venv..."
    source venv/bin/activate
fi

echo ""
echo "üì¶ –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É pika..."
pip uninstall pika -y

echo ""
echo "üì¶ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º aio-pika..."
pip install aio-pika==9.4.3

echo ""
echo "‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"
echo ""
echo "üß™ –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç RabbitMQ..."
python test_rabbitmq.py

echo ""
echo "================================================"
echo "‚ú® –ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –∏ –≤–æ—Ä–∫–µ—Ä–∞:"
echo "   python main.py"
echo "   python run_worker.py"

